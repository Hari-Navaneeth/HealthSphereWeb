"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[519],{9519:(G,g,r)=>{r.r(g),r.d(g,{StaffModule:()=>L});var _=r(6814),c=r(7538),t=r(4946),b=r(879);let u=(()=>{class i{constructor(a){this._apiService=a,this.addStaff=e=>this._apiService.post({url:"staff",data:e}),this.getStaffs=e=>this._apiService.get("staff",e),this.getStaff=e=>this._apiService.get(`staff/${e}`),this.updateStaff=e=>this._apiService.put({url:"panels/staff/update-staff",data:e}),this.deleteStaff=e=>this._apiService.delete(`staff/${e}`)}static#t=this.\u0275fac=function(e){return new(e||i)(t.LFG(b.s))};static#e=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var S=r(7870),m=r(95),h=r(5219),p=r(707),v=r(6340),C=r(3714),T=r(8402);function y(i,f){1&i&&(t.TgZ(0,"div",6),t._uU(1," Staff Management "),t.qZA())}function x(i,f){if(1&i){const a=t.EpF();t.TgZ(0,"div",7)(1,"p-button",8),t.NdJ("click",function(){t.CHM(a);const o=t.oxw();return t.KtG(o.addStaff())}),t.qZA(),t.TgZ(2,"span",9),t._UZ(3,"i",10),t.TgZ(4,"input",11),t.NdJ("ngModelChange",function(o){t.CHM(a);const l=t.oxw();return t.KtG(l.searchQuery=o)})("input",function(){t.CHM(a);const o=t.oxw();return t.KtG(o.getStaff())}),t.qZA()()()}if(2&i){const a=t.oxw();t.xp6(4),t.Q6J("ngModel",a.searchQuery)}}let A=(()=>{class i{constructor(a,e,o){this._router=a,this._staffService=e,this._sharedService=o,this.tableData={data:[],columns:[{header:"Staff Name",field:"fullName",columnType:"Text"},{header:"Email",field:"email",columnType:"Text",align:"center"},{header:"Phone",field:"phoneNumber",columnType:"Phone"},{header:"Action",columnType:"Action",align:"center",actions:[{icon:"pi pi-eye",class:"p-button-info",label:"View"},{icon:"pi pi-trash",class:"p-button-danger",label:"Delete"}]}],count:0},this.searchQuery="",this.isStaffTableLoading=!1,this.getStaff=(l={limit:10,offset:0})=>{this.isStaffTableLoading=!0,this._staffService.getStaffs({limit:l.limit,offset:l.offset,query:this.searchQuery}).subscribe(({data:n,count:s})=>{console.log(n,s),this.isStaffTableLoading=!1,this.tableData.data=JSON.parse(JSON.stringify(n)).map(d=>({...d,fullName:[d.firstName,d.lastName].join(" "),age:String(this._sharedService.calculateAge(d.dateOfBirth))})),this.tableData.count=s},n=>{this.isStaffTableLoading=!1})},this.addStaff=()=>this._router.navigate(["/staff/add"])}ngOnInit(){this.getStaff()}onAction(a){switch(a.action){case"View":this._router.navigate(["/staff/view",a.rowData._id||"1"]);break;case"Delete":this.deleteStaff(a.rowData._id||"1")}}deleteStaff(a){this._staffService.deleteStaff(a).subscribe(e=>{console.log(e),this.getStaff()})}static#t=this.\u0275fac=function(e){return new(e||i)(t.Y36(c.F0),t.Y36(u),t.Y36(S.F))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-staff"]],decls:6,vars:4,consts:[[1,"card"],["styleClass","mb-4 gap-2"],["pTemplate","left"],["pTemplate","right"],[1,"col-12","p-0"],["showExportButtons","true","fileName","Staff",3,"value","columns","totalRecords","loading","onPageChange","onAction"],[1,"text-2xl","font-semibold","vertical-align-middle"],[1,"flex","flex-wrap","gap-2"],["label","Add Staff","styleClass","p-button-raised",3,"click"],[1,"p-input-icon-left","ml-auto"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search keyword",3,"ngModel","ngModelChange","input"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"p-toolbar",1),t.YNc(2,y,2,0,"ng-template",2),t.YNc(3,x,5,1,"ng-template",3),t.qZA(),t.TgZ(4,"div",4)(5,"app-common-table",5),t.NdJ("onPageChange",function(n){return o.getStaff(n)})("onAction",function(n){return o.onAction(n)}),t.qZA()()()),2&e&&(t.xp6(5),t.Q6J("value",o.tableData.data)("columns",o.tableData.columns)("totalRecords",o.tableData.count)("loading",o.isStaffTableLoading))},dependencies:[m.Fj,m.JJ,m.On,h.jx,p.zx,v.o,C.o,T.u]})}return i})();var N=r(9239),Z=r(1752),w=r(9030),M=r(5160);function J(i,f){1&i&&(t.TgZ(0,"div",10),t._uU(1," Add Staff "),t.qZA())}function k(i,f){if(1&i){const a=t.EpF();t.TgZ(0,"div",11)(1,"app-common-input",6),t.NdJ("valueChange",function(o){const n=t.CHM(a).$implicit,s=t.oxw();return t.KtG(s.formModel[n.id]=o)})("valueChange",function(o){const n=t.CHM(a).$implicit,s=t.oxw();return t.KtG(s.updateModel(o,n))}),t.qZA()()}if(2&i){const a=f.$implicit,e=t.oxw();t.xp6(1),t.Q6J("property",a)("value",e.formModel[a.id])}}function F(i,f){if(1&i){const a=t.EpF();t.TgZ(0,"div",11)(1,"app-common-input",6),t.NdJ("valueChange",function(o){const n=t.CHM(a).$implicit,s=t.oxw();return t.KtG(s.formModel[n.id]=o)})("valueChange",function(o){const n=t.CHM(a).$implicit,s=t.oxw();return t.KtG(s.updateModel(o,n))}),t.qZA()()}if(2&i){const a=f.$implicit,e=t.oxw();t.xp6(1),t.Q6J("property",a)("value",e.formModel[a.id])}}let D=(()=>{class i{constructor(a,e,o,l){this._router=a,this._staffService=e,this._validationService=o,this._sharedService=l,this.formModel={},this.loading=!1,this.formControls1=[{label:"First Name",required:!0,inputType:"Name",id:"firstName",validator:this._validationService.nameValidator},{label:"Last Name",required:!0,inputType:"Name",id:"lastName",validator:this._validationService.nameValidator},{label:"Date of Birth",inputType:"Date",required:!0,id:"dateOfBirth",maxDate:new Date,validator:n=>this._validationService.dateValidator(n)&&n<new Date},{label:"Age",inputType:"Name",id:"age",disabled:!0,maxLength:3,validator:this._validationService.numberValidator},{label:"Sex",inputType:"Dropdown",options:["Male","Female","Other"],optionTypeStr:!0,id:"gender",required:!0,validator:this._validationService.emptyValueValidator}],this.addressControl={label:"Address",required:!0,inputType:"TextArea",id:"address",rows:2,validator:this._validationService.stringValidator,maxLength:500},this.formControls2=[{label:"City",required:!0,inputType:"AutoComplete",id:"city",validator:this._validationService.stringValidator,suggestions:Z},{label:"State",required:!0,inputType:"Dropdown",id:"state",validator:this._validationService.emptyValueValidator,options:N},{label:"Zip",required:!0,inputType:"Number",id:"zip",maxLength:6,validator:this._validationService.zipCodeValidator},{label:"Phone",required:!0,inputType:"Number",id:"phoneNumber",maxLength:10,validator:this._validationService.phoneValidator,preAddon:"pi-phone"},{label:"Email",required:!0,inputType:"Text",id:"email",validator:this._validationService.emailValidator,preAddon:"pi-envelope"}],this.submitTried=!1,this.validator=n=>{let s=!0;const d=this.formModel[n.id];return n.required&&n.validator&&(n.validator(d)?n.invalid=!1:(n.invalid=!0,s=!1)),console.log(n,d,s),s},this.updateModel=(n,s)=>{"dateOfBirth"===s.id&&(this.formModel.age=n?String(this._sharedService.calculateAge(n)):null),this.submitTried&&this.validator(s)},this.validate=()=>{let n=!0;const s=d=>{this.validator(d)||(n=!1)};return this.formControls1.forEach(s),s(this.addressControl),this.formControls2.forEach(s),n},this.submit=()=>{if(this.submitTried=!0,this.validate()){this.loading=!0;const s=JSON.parse(JSON.stringify(this.formModel));this._staffService.addStaff(s).subscribe(d=>{this.loading=!1,this._router.navigate(["/staff"])},d=>{this.loading=!1,console.log(d),this._sharedService.toast.showWarn(409===d.status?{heading:"Error",message:"Staff already exists"}:500===d.status?{heading:"Error",message:d.error.error}:{heading:"Error",message:"Something went wrong"})})}},this.back=()=>{this._router.navigate(["/staff"])}}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}static#t=this.\u0275fac=function(e){return new(e||i)(t.Y36(c.F0),t.Y36(u),t.Y36(w.R),t.Y36(S.F))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-add-staff"]],decls:11,vars:5,consts:[[1,"card"],["styleClass","m-3 mb-4 gap-2"],["pTemplate","left"],[1,"flex","flex-wrap"],["class","field col-12 md:col-4 py-2",4,"ngFor","ngForOf"],[1,"field","col-12","md:col-8","py-2"],[3,"property","value","valueChange"],[1,"col-12","flex","justify-content-between"],["pButton","","pRipple","","type","button","label","Back","icon","pi pi-arrow-left","iconPos","left",1,"p-button-outlined","p-button-raised","p-button-danger",3,"click"],["pButton","","pRipple","","type","button","label","Submit",1,"p-button-outlined","p-button-raised","p-button-success",3,"loading","click"],[1,"text-2xl","font-semibold","vertical-align-middle"],[1,"field","col-12","md:col-4","py-2"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"p-toolbar",1),t.YNc(2,J,2,0,"ng-template",2),t.qZA(),t.TgZ(3,"div",3),t.YNc(4,k,2,2,"div",4),t.TgZ(5,"div",5)(6,"app-common-input",6),t.NdJ("valueChange",function(n){return o.formModel[o.addressControl.id]=n})("valueChange",function(n){return o.updateModel(n,o.addressControl)}),t.qZA()(),t.YNc(7,F,2,2,"div",4),t.TgZ(8,"div",7)(9,"button",8),t.NdJ("click",function(){return o.back()}),t.qZA(),t.TgZ(10,"button",9),t.NdJ("click",function(){return o.submit()}),t.qZA()()()()),2&e&&(t.xp6(4),t.Q6J("ngForOf",o.formControls1),t.xp6(2),t.Q6J("property",o.addressControl)("value",o.formModel[o.addressControl.id]),t.xp6(1),t.Q6J("ngForOf",o.formControls2),t.xp6(3),t.Q6J("loading",o.loading))},dependencies:[_.sg,h.jx,p.Hq,v.o,M.v]})}return i})();var V=r(8541),Y=r(1687),I=r(5118),O=r(1843);function B(i,f){1&i&&(t.TgZ(0,"div",7),t._uU(1," Staff Info "),t.qZA())}const P=[{path:"",component:A},{path:"add",component:D},{path:"view/:id",component:(()=>{class i{constructor(a,e,o,l,n){this._activatedRoute=a,this._router=e,this._staffService=o,this.toasterService=l,this.dialogService=n,this.staffId="",this.staffInfo=[],this.back=()=>this._router.navigate(["/staff"]),this.resetPassword=()=>{this.ref=this.dialogService.open(V.L,{header:"Reset Password",contentStyle:{overflow:"auto"},baseZIndex:1e4,data:{id:this.staffId}})}}ngOnInit(){this._activatedRoute.paramMap.subscribe(a=>{this.staffId=a.params.id,this.getStaffInfo()})}getStaffInfo(){console.log(this.staffId),this._staffService.getStaff(this.staffId).subscribe(a=>{const{firstName:e,lastName:o,gender:l,age:n,email:s,phoneNumber:d,address:R,state:z,city:j,zip:q}=a;this.staffInfo=[{key:"Name",value:e+" "+o},{key:"Gender",value:l},{key:"Age",value:n},{key:"Email",value:s},{key:"Phone",value:d},{key:"Address",value:R},{key:"City",value:j},{key:"State",value:z},{key:"Zip",value:q}]},a=>{500===a.status?(this.toasterService.error("Staff not found"),this._router.navigate(["/staff"])):(this.toasterService.error("Something went wrong"),this._router.navigate(["/staff"]))})}static#t=this.\u0275fac=function(e){return new(e||i)(t.Y36(c.gz),t.Y36(c.F0),t.Y36(u),t.Y36(Y.M),t.Y36(I.xA))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-view-staff"]],decls:7,vars:1,consts:[["styleClass","mb-4 gap-2"],["pTemplate","left"],[1,"card"],[3,"viewData"],[1,"flex","justify-content-between"],["pButton","","pRipple","","type","button","label","Back","icon","pi pi-arrow-left","iconPos","left",1,"p-button-outlined","p-button-raised","p-button-danger",3,"click"],["icon","pi pi-info-circle","label","Reset Password",3,"click"],[1,"text-2xl","font-semibold","vertical-align-middle"]],template:function(e,o){1&e&&(t.TgZ(0,"p-toolbar",0),t.YNc(1,B,2,0,"ng-template",1),t.qZA(),t.TgZ(2,"div",2),t._UZ(3,"app-common-text-view",3),t.TgZ(4,"div",4)(5,"button",5),t.NdJ("click",function(){return o.back()}),t.qZA(),t.TgZ(6,"p-button",6),t.NdJ("click",function(){return o.resetPassword()}),t.qZA()()()),2&e&&(t.xp6(3),t.Q6J("viewData",o.staffInfo))},dependencies:[h.jx,p.Hq,p.zx,v.o,O.h]})}return i})()}];let Q=(()=>{class i{static#t=this.\u0275fac=function(e){return new(e||i)};static#e=this.\u0275mod=t.oAB({type:i});static#a=this.\u0275inj=t.cJS({imports:[c.Bz.forChild(P),c.Bz]})}return i})();var E=r(2692);let L=(()=>{class i{static#t=this.\u0275fac=function(e){return new(e||i)};static#e=this.\u0275mod=t.oAB({type:i});static#a=this.\u0275inj=t.cJS({imports:[_.ez,Q,E.R]})}return i})()}}]);