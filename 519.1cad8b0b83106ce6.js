"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[519],{9519:(j,g,l)=>{l.r(g),l.d(g,{StaffModule:()=>Q});var _=l(6814),c=l(7538),t=l(4946),S=l(879);let u=(()=>{class o{constructor(a){this._apiService=a,this.addStaff=e=>this._apiService.post({url:"staff",data:e}),this.getStaffs=e=>this._apiService.get("staff",e),this.getStaff=e=>this._apiService.get(`staff/${e}`),this.updateStaff=e=>this._apiService.put({url:"panels/staff/update-staff",data:e}),this.deleteStaff=e=>this._apiService.delete(`staff/${e}`)}static#t=this.\u0275fac=function(e){return new(e||o)(t.LFG(S.s))};static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var m=l(95),h=l(5219),p=l(707),v=l(6340),b=l(3714),C=l(8402);function T(o,f){1&o&&(t.TgZ(0,"div",6),t._uU(1," Staff Management "),t.qZA())}function y(o,f){if(1&o){const a=t.EpF();t.TgZ(0,"div",7)(1,"p-button",8),t.NdJ("click",function(){t.CHM(a);const i=t.oxw();return t.KtG(i.addStaff())}),t.qZA(),t.TgZ(2,"span",9),t._UZ(3,"i",10),t.TgZ(4,"input",11),t.NdJ("ngModelChange",function(i){t.CHM(a);const s=t.oxw();return t.KtG(s.searchQuery=i)})("input",function(){t.CHM(a);const i=t.oxw();return t.KtG(i.getStaff())}),t.qZA()()()}if(2&o){const a=t.oxw();t.xp6(4),t.Q6J("ngModel",a.searchQuery)}}let x=(()=>{class o{constructor(a,e){this.staffService=a,this.router=e,this.tableData={data:[],columns:[{header:"First Name",field:"firstName",columnType:"Text"},{header:"Last Name",field:"lastName",columnType:"Text"},{header:"Email",field:"email",columnType:"Text",align:"center"},{header:"Phone",field:"phoneNumber",columnType:"Phone"},{header:"Action",columnType:"Action",align:"center",actions:[{icon:"pi pi-eye",class:"p-button-info",label:"View"},{icon:"pi pi-trash",class:"p-button-danger",label:"Delete"}]}],count:0},this.searchQuery="",this.isStaffTableLoading=!1,this.getStaff=(i={limit:10,offset:0})=>{this.isStaffTableLoading=!0,this.staffService.getStaffs({limit:i.limit,offset:i.offset}).subscribe(({data:s,count:n})=>{console.log(s,n),this.isStaffTableLoading=!1,this.tableData.data=JSON.parse(JSON.stringify(s)),this.tableData.count=n},s=>{this.isStaffTableLoading=!1})},this.addStaff=()=>this.router.navigate(["/staff/add"])}ngOnInit(){this.getStaff()}onAction(a){switch(a.action){case"View":this.router.navigate(["/staff/view",a.rowData._id||"1"]);break;case"Delete":this.deleteStaff(a.rowData._id||"1")}}deleteStaff(a){this.staffService.deleteStaff(a).subscribe(e=>{console.log(e),this.getStaff()})}static#t=this.\u0275fac=function(e){return new(e||o)(t.Y36(u),t.Y36(c.F0))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-staff"]],decls:6,vars:4,consts:[[1,"card"],["styleClass","mb-4 gap-2"],["pTemplate","left"],["pTemplate","right"],[1,"col-12","p-0"],["showExportButtons","true","fileName","Staff",3,"value","columns","totalRecords","loading","onPageChange","onAction"],[1,"text-2xl","font-semibold","vertical-align-middle"],[1,"flex","flex-wrap","gap-2"],["label","Add Staff","styleClass","p-button-raised",3,"click"],[1,"p-input-icon-left","ml-auto"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search keyword",3,"ngModel","ngModelChange","input"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"p-toolbar",1),t.YNc(2,T,2,0,"ng-template",2),t.YNc(3,y,5,1,"ng-template",3),t.qZA(),t.TgZ(4,"div",4)(5,"app-common-table",5),t.NdJ("onPageChange",function(n){return i.getStaff(n)})("onAction",function(n){return i.onAction(n)}),t.qZA()()()),2&e&&(t.xp6(5),t.Q6J("value",i.tableData.data)("columns",i.tableData.columns)("totalRecords",i.tableData.count)("loading",i.isStaffTableLoading))},dependencies:[m.Fj,m.JJ,m.On,h.jx,p.zx,v.o,b.o,C.u]})}return o})();var A=l(9239),w=l(1752),N=l(9030),Z=l(7870),M=l(5160);function J(o,f){1&o&&(t.TgZ(0,"div",10),t._uU(1," Add Staff "),t.qZA())}function k(o,f){if(1&o){const a=t.EpF();t.TgZ(0,"div",11)(1,"app-common-input",6),t.NdJ("valueChange",function(i){const n=t.CHM(a).$implicit,r=t.oxw();return t.KtG(r.formModel[n.id]=i)})("valueChange",function(i){const n=t.CHM(a).$implicit,r=t.oxw();return t.KtG(r.updateModel(i,n))}),t.qZA()()}if(2&o){const a=f.$implicit,e=t.oxw();t.xp6(1),t.Q6J("property",a)("value",e.formModel[a.id])}}function F(o,f){if(1&o){const a=t.EpF();t.TgZ(0,"div",11)(1,"app-common-input",6),t.NdJ("valueChange",function(i){const n=t.CHM(a).$implicit,r=t.oxw();return t.KtG(r.formModel[n.id]=i)})("valueChange",function(i){const n=t.CHM(a).$implicit,r=t.oxw();return t.KtG(r.updateModel(i,n))}),t.qZA()()}if(2&o){const a=f.$implicit,e=t.oxw();t.xp6(1),t.Q6J("property",a)("value",e.formModel[a.id])}}let D=(()=>{class o{constructor(a,e,i,s){this._router=a,this._staffService=e,this._validationService=i,this._sharedService=s,this.formModel={},this.loading=!1,this.formControls1=[{label:"First Name",required:!0,inputType:"Name",id:"firstName",validator:this._validationService.nameValidator},{label:"Last Name",required:!0,inputType:"Name",id:"lastName",validator:this._validationService.nameValidator},{label:"Date of Birth",inputType:"Date",required:!0,id:"dateOfBirth",maxDate:new Date,validator:n=>this._validationService.dateValidator(n)&&n<new Date},{label:"Age",inputType:"Name",id:"age",disabled:!0,maxLength:3,validator:this._validationService.numberValidator},{label:"Sex",inputType:"Dropdown",options:["Male","Female","Other"],optionTypeStr:!0,id:"gender",validator:this._validationService.emptyValueValidator}],this.addressControl={label:"Address",required:!0,inputType:"TextArea",id:"address",rows:2,validator:this._validationService.stringValidator,maxLength:500},this.formControls2=[{label:"City",required:!0,inputType:"AutoComplete",id:"city",validator:this._validationService.stringValidator,suggestions:w},{label:"State",required:!0,inputType:"Dropdown",id:"state",validator:this._validationService.emptyValueValidator,options:A},{label:"Zip",required:!0,inputType:"Number",id:"zip",maxLength:6,validator:this._validationService.zipCodeValidator},{label:"Phone",required:!0,inputType:"Number",id:"phoneNumber",maxLength:10,validator:this._validationService.phoneValidator,preAddon:"pi-phone"},{label:"Email",required:!0,inputType:"Text",id:"email",validator:this._validationService.emailValidator,preAddon:"pi-envelope"}],this.submitTried=!1,this.validator=n=>{let r=!0;const d=this.formModel[n.id];return n.required&&n.validator&&(n.validator(d)?n.invalid=!1:(n.invalid=!0,r=!1)),console.log(n,d,r),r},this.updateModel=(n,r)=>{"dateOfBirth"===r.id&&(this.formModel.age=n?String(this._sharedService.calculateAge(n)):null),this.submitTried&&this.validator(r)},this.validate=()=>{let n=!0;const r=d=>{this.validator(d)||(n=!1)};return this.formControls1.forEach(r),r(this.addressControl),this.formControls2.forEach(r),n},this.submit=()=>{if(this.submitTried=!0,this.validate()){this.loading=!0;const r=JSON.parse(JSON.stringify(this.formModel));this._staffService.addStaff(r).subscribe(d=>{this.loading=!1,this._router.navigate(["/staff"])},d=>{this.loading=!1,console.log(d),this._sharedService.toast.showWarn(409===d.status?{heading:"Error",message:"Staff already exists"}:500===d.status?{heading:"Error",message:d.error.error}:{heading:"Error",message:"Something went wrong"})})}},this.back=()=>{this._router.navigate(["/staff"])}}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}static#t=this.\u0275fac=function(e){return new(e||o)(t.Y36(c.F0),t.Y36(u),t.Y36(N.R),t.Y36(Z.F))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-add-staff"]],decls:11,vars:5,consts:[[1,"card"],["styleClass","m-3 mb-4 gap-2"],["pTemplate","left"],[1,"flex","flex-wrap"],["class","field col-12 md:col-4 py-2",4,"ngFor","ngForOf"],[1,"field","col-12","md:col-8","py-2"],[3,"property","value","valueChange"],[1,"col-12","flex","justify-content-between"],["pButton","","pRipple","","type","button","label","Back","icon","pi pi-arrow-left","iconPos","left",1,"p-button-outlined","p-button-raised","p-button-danger",3,"click"],["pButton","","pRipple","","type","button","label","Submit",1,"p-button-outlined","p-button-raised","p-button-success",3,"loading","click"],[1,"text-2xl","font-semibold","vertical-align-middle"],[1,"field","col-12","md:col-4","py-2"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"p-toolbar",1),t.YNc(2,J,2,0,"ng-template",2),t.qZA(),t.TgZ(3,"div",3),t.YNc(4,k,2,2,"div",4),t.TgZ(5,"div",5)(6,"app-common-input",6),t.NdJ("valueChange",function(n){return i.formModel[i.addressControl.id]=n})("valueChange",function(n){return i.updateModel(n,i.addressControl)}),t.qZA()(),t.YNc(7,F,2,2,"div",4),t.TgZ(8,"div",7)(9,"button",8),t.NdJ("click",function(){return i.back()}),t.qZA(),t.TgZ(10,"button",9),t.NdJ("click",function(){return i.submit()}),t.qZA()()()()),2&e&&(t.xp6(4),t.Q6J("ngForOf",i.formControls1),t.xp6(2),t.Q6J("property",i.addressControl)("value",i.formModel[i.addressControl.id]),t.xp6(1),t.Q6J("ngForOf",i.formControls2),t.xp6(3),t.Q6J("loading",i.loading))},dependencies:[_.sg,h.jx,p.Hq,v.o,M.v]})}return o})();var V=l(8541),Y=l(1687),I=l(5118),O=l(1843);function B(o,f){1&o&&(t.TgZ(0,"div",7),t._uU(1," Staff Info "),t.qZA())}const L=[{path:"",component:x},{path:"add",component:D},{path:"view/:id",component:(()=>{class o{constructor(a,e,i,s,n){this._activatedRoute=a,this._router=e,this._staffService=i,this.toasterService=s,this.dialogService=n,this.staffId="",this.staffInfo=[],this.back=()=>this._router.navigate(["/staff"]),this.resetPassword=()=>{this.ref=this.dialogService.open(V.L,{header:"Reset Password",contentStyle:{overflow:"auto"},baseZIndex:1e4,data:{id:this.staffId}})}}ngOnInit(){this._activatedRoute.paramMap.subscribe(a=>{this.staffId=a.params.id,this.getStaffInfo()})}getStaffInfo(){console.log(this.staffId),this._staffService.getStaff(this.staffId).subscribe(a=>{const{firstName:e,lastName:i,gender:s,age:n,email:r,phoneNumber:d,address:R,state:z,city:G,zip:H}=a;this.staffInfo=[{key:"Name",value:e+" "+i},{key:"Gender",value:s},{key:"Age",value:n},{key:"Email",value:r},{key:"Phone",value:d},{key:"Address",value:R},{key:"City",value:G},{key:"State",value:z},{key:"Zip",value:H}]},a=>{500===a.status?(this.toasterService.error("Staff not found"),this._router.navigate(["/staff"])):(this.toasterService.error("Something went wrong"),this._router.navigate(["/staff"]))})}static#t=this.\u0275fac=function(e){return new(e||o)(t.Y36(c.gz),t.Y36(c.F0),t.Y36(u),t.Y36(Y.M),t.Y36(I.xA))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-view-staff"]],decls:7,vars:1,consts:[["styleClass","mb-4 gap-2"],["pTemplate","left"],[1,"card"],[3,"viewData"],[1,"flex","justify-content-between"],["pButton","","pRipple","","type","button","label","Back","icon","pi pi-arrow-left","iconPos","left",1,"p-button-outlined","p-button-raised","p-button-danger",3,"click"],["icon","pi pi-info-circle","label","Reset Password",3,"click"],[1,"text-2xl","font-semibold","vertical-align-middle"]],template:function(e,i){1&e&&(t.TgZ(0,"p-toolbar",0),t.YNc(1,B,2,0,"ng-template",1),t.qZA(),t.TgZ(2,"div",2),t._UZ(3,"app-common-text-view",3),t.TgZ(4,"div",4)(5,"button",5),t.NdJ("click",function(){return i.back()}),t.qZA(),t.TgZ(6,"p-button",6),t.NdJ("click",function(){return i.resetPassword()}),t.qZA()()()),2&e&&(t.xp6(3),t.Q6J("viewData",i.staffInfo))},dependencies:[h.jx,p.Hq,p.zx,v.o,O.h]})}return o})()}];let P=(()=>{class o{static#t=this.\u0275fac=function(e){return new(e||o)};static#e=this.\u0275mod=t.oAB({type:o});static#a=this.\u0275inj=t.cJS({imports:[c.Bz.forChild(L),c.Bz]})}return o})();var E=l(2692);let Q=(()=>{class o{static#t=this.\u0275fac=function(e){return new(e||o)};static#e=this.\u0275mod=t.oAB({type:o});static#a=this.\u0275inj=t.cJS({imports:[_.ez,P,E.R]})}return o})()}}]);